# **✅ Excel入力マニュアル（Excel → JSON → Word のための記述ルール）**







## **0) 基本ルール（シート全体）**





- **A列：タグ（必須）**

  例：b_question, select, image など

- **B列以降：タグのパラメータ**（タグごとに意味が変わる）

- **A列が空の行 / 行自体が空**は無視されます。

- **未対応タグ（コードに登場しないタグ）**は “無視されます”

  例：b_examnote, e_examnote, b_answer など（現状のこの関数では処理しません）





------





## **1) 試験の表紙ブロック（b_exam ～ e_exam）**





試験情報（タイトル・科目番号・年度など）を入れるブロックです。

| **タグ**  | **入力列** | **内容**                                               |
| --------- | ---------- | ------------------------------------------------------ |
| b_exam    | A          | 表紙ブロック開始                                       |
| examtitle | B          | 試験タイトル                                           |
| examnote  | B          | 注意書き（複数行OK：行を増やして examnote を複数置く） |
| subject   | B          | 科目番号（例：1010401）                                |
| fsyear    | B          | 年度（例：2025）                                       |
| ansnote   | B          | 解答欄の注意（あれば）                                 |
| anssize   | B          | 解答用紙サイズ **(幅,高さ)** 例：(50.0,60.0)           |
| e_exam    | A          | 表紙ブロック終了（ここで表紙が results[0] に入る）     |

📌注意：あなたのExcelには b_examnote/e_examnote が入っていましたが、**この関数では無視**されます。使うなら **examnote を複数行**にしてください（またはコード対応が必要）。



------





## **2) バージョン（A/Bなど）の指定：qpattern**



| **タグ** | **入力列** | **内容**                |
| -------- | ---------- | ----------------------- |
| qpattern | B          | 例：A,B（カンマ区切り） |



- qpattern が **未指定 or** **A****のみ** → versionmode="single"
- qpattern に複数（例：A,B） → versionmode="multi"
- **選択肢の並び替え（order）**は version != "A" のときにだけ適用されます（= B版など）





------





## **3) 大問ブロック（b_question ～ e_question）**





大問を1つ作ります。

| **タグ**   | **入力列** | **内容**                                                   |
| ---------- | ---------- | ---------------------------------------------------------- |
| b_question | A          | 大問開始（自動で問番号が 1,2,3… と増える）                 |
| question   | B          | 大問の問題文（1行）                                        |
| e_question | A          | 大問終了（content/subquestions を確定して results に追加） |



------





## **4) 大問の本文要素（contentに入るもの）**







### **4-1) 単独テキスト行：sline**



| **タグ** | **入力列** | **内容**                                  |
| -------- | ---------- | ----------------------------------------- |
| sline    | B          | 表示する1行テキスト                       |
|          | C          | スペース指定 **(before,after)** 例：(0,0) |

※ C列が “スペース指定” です（コード上 row[2] を見ています）。



------





### **4-2) 複数行テキスト：b_multiline ～ e_multiline**



| **タグ**    | **入力列** | **内容**                                  |
| ----------- | ---------- | ----------------------------------------- |
| b_multiline | B          | スペース指定 **(before,after)** 例：(5,0) |
| text        | B          | 1行分の本文（複数行OK）                   |
| e_multiline | A          | multiline終了（contentに追加）            |



------





### **4-3) 選択肢：b_select ～ e_select**



| **タグ** | **入力列** | **内容**                                              |
| -------- | ---------- | ----------------------------------------------------- |
| b_select | B          | 表示スタイル：normal / inline / inline(8) など        |
| select   | B          | 選択肢本文                                            |
|          | C          | ラベル（任意）例：A（空なら自動でA,B,C…）             |
|          | G          | **並び順番号 order（任意）**：B版などで並び替えに使う |
| e_select | A          | 選択肢終了（contentに追加）                           |

📌 G列(order) の挙動



- version != "A" のときだけ有効（B版など）
- order が1つでも入っていれば、**小さい順に並べ替え**
- 全部空なら並べ替えなし





------





### **4-4) コードブロック：b_code ～ e_code**



| **タグ** | **入力列** | **内容**                                         |
| -------- | ---------- | ------------------------------------------------ |
| b_code   | B          | linenumber を入れると行番号表示ON、それ以外はOFF |
| code     | B          | コード1行（複数行OK）                            |
| e_code   | A          | code終了（contentに追加）                        |



------





### **4-5) 画像：image**





ここがご指定の箇所です。

| **タグ** | **入力列** | **内容**                                       |
| -------- | ---------- | ---------------------------------------------- |
| image    | B          | **ファイル名[幅]** 例：3.png[6.5] / 7.png[4.5] |



- [] の数値が **幅**としてJSONに入り、Word側でその幅で配置される想定です
- 画像ファイルの置き場所は、後段のWord出力側の仕様に依存します（少なくともJSONには path と width が出ます）





------





### **4-6) 改ページ：PAGEBREAK**



| **タグ**  | **入力列** | **内容**                                         |
| --------- | ---------- | ------------------------------------------------ |
| PAGEBREAK | （任意）   | content（またはsubgroup内）に pagebreak を入れる |

※ B列に PAGEBREAK と書いても構いませんが、コード上は不要です。



------





### **4-7) 行空き：LINESPACE**



| **タグ**  | **入力列** | **内容**                           |
| --------- | ---------- | ---------------------------------- |
| LINESPACE | B          | 行数（数字）例：2（未指定は1扱い） |



------





## **5) 小問（subquestions）の作り方：b_subgroup ～ e_subgroup**





「大問の中に小問を並べたい」場合に使います。

| **タグ**                          | **入力列** | **内容**                               |
| --------------------------------- | ---------- | -------------------------------------- |
| b_subgroup                        | A          | 小問グループ開始                       |
| b_subquest                        | A          | 小問開始（小問番号 1,2,3… が自動付与） |
| subquest                          | B          | 小問の問題文                           |
| subsline                          | B          | 小問の単独1行テキスト                  |
|                                   | C          | スペース (before,after)                |
| b_submultiline                    | B          | スペース (before,after)                |
| subtext                           | B          | 小問 multiline の1行                   |
| e_submultiline                    | A          | 小問 multiline 終了                    |
| b_subselect/subselect/e_subselect | B/C/G      | 選択肢（大問selectと同じ）             |
| b_subcode/subcode/e_subcode       | B          | コード（大問codeと同じ）               |
| subimage                          | B          | 画像（ファイル名[幅]）                 |
| e_subquest                        | A          | 小問終了（subquestionsに追加）         |
| e_subgroup                        | A          | 小問グループ終了（大問に取り込む）     |

📌 PAGEBREAK / LINESPACE は、subgroup中では **subquestions配列に直接入る**実装になっています（小問の途中に挟めます）。



------





# **✅ 最低限の「書き方テンプレ」（例）**





（実際にあなたのシート 1010401 でも概ねこの形でした）



- b_exam → examtitle/subject/fsyear/anssize/... → e_exam
- qpattern（A,B）
- b_question → question →（本文：b_multilineやb_selectやimageなど）→ e_question
- 小問が必要なら b_subgroup を挟む





------



次は、あなたが貼ってくれる（or 既にある）**Excelの実データ**に合わせて、



- 「無視されているタグ（例：b_examnote）をどう扱うのが正解か」
- 「Word出力側が期待する画像パスの基準ディレクトリ」
- 「anssize / spacing がWord側でどう効くか」





まで含めて、**完成版の運用マニュアル**に整形できます。



Excel（該当シート）を貼るか、タグ一覧だけでも出してくれれば、それに合わせて“この運用ではこう書く”に確定します。